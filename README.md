------------------------------------------------------------------------

bibliography: analysis_proteomics.bib

------------------------------------------------------------------------

# ADP-heptose attenuates *H. pylori*-induced type I IFN signaling in DCs and impairs subsequent T cell responses

This repository complements the publication by Neuper, Frauenlob et al (2023)

## Folders

-   `analysis` : output files generated by the scripts in the scripts folder
-   `scripts` : scripts for the proteomic analysis
-   `data` : raw input data

## Raw mass spectrometry data

The mass spectrometry proteomics data have been deposited to the ProteomeXchange Consortium (<http://www.proteomexchange.org/>) via the PRIDE partner repository with the dataset identifier PXD046603.

Prior to the analysis in this repository, the mass spectrometry proteomics data was treated in the following way:

For data evaluation, MaxQuant 2.0.1.0 [@Cox2008] was used in default settings for label-free quantification (LFQ), employing a protein database from the Uniprot consortium [@Bateman2020] Homo sapiens from 19.12.2022 applying a 1% false discovery rate. The obtained protein groups were processed using the Perseus software platform [@Rudolph2018]. First, the protein groups were filtered by removing proteins that were only identified by site and reverse sequence matches. Next, the intensities were log2 transformed and normalized by subtraction of the median.

Such log2-transformed, normalized, and batch-corrected data tables can be downloaded from the Zenodo repository xx.

## Analysis description

This repository contains scripts for the following analysis:

Analysis for differential protein expression was performed using linear models as part of the limma package [@Ritchie2015] in R. Initial exploratory data analysis revealed clustering of data by the experimental run, indicating that a batch-effect was present. The batch-effect was corrected for by the removeBatchEffect() function within limma. Uniprot protein IDs were matched with their respective gene IDs downloaded from the Uniprot database for Homo sapiens and Helicobacter pylori reviewed (SwissProt) entries. Gene set enrichment analysis was performed using the fgsea [@Korotkevich2016] package . The following databases were downloaded from the EnrichR database [@Chen2013][@Kuleshov2016] for the fgsea analysis: WikiPathways_2019_Human, NCI-Nature_2016, TRRUST_Transcription_Factors_2019, MSigDB_Hallmark_2020, GO_Cellular_Component_2018, CORUM, KEGG_2019_Human, TRANSFAC_and_JASPAR_PWMs, ENCODE_and_ChEA_Consensus_TFs_from_ChIP-X, GO_Biological_Process_2018, GO_Molecular_Function_2018, Human_Gene_Atlas.

## Main workflow

## Download data

Create a folder `data` that will contain raw data downloaded from the following link: [link to data]

## Main workflow

Run these R scripts in the given in order to generate all files & plots

-   [01_merge_data.R](scripts/01_merge_data.R) - Loads and merges all datasets, loads meta data, saves merged dataset and meta data. Produces one intermediary dataset: allData.Rdata
-   [02_explore_data.R](scripts/02_explore_data.R) - Explores data with PCA and Pearson's correlation, corrects for batch-effect. Produces one intermediary dataset: allData.Rdata
-   [03_analyse_dge.R](scripts/03_analyse_dge.R) - Analyses differential protein expression using linear models package limma. Produces one intermediary dataset: results_dge.rds
-   [04_map_protein_to_gene.R](scripts/04_map_protein_to_gene.R) - Maps protein ids to gene ids. Produces two intermediary datasets: results_dge.rds and all_data.RData
-   [05_plot_dge_results.R](scripts/05_plot_dge_results.R) - Plots volcano plots, pval histograms and heatmaps of dge analysis
-   [06_download_enrichr_database.R](scripts/06_download_enrichr_database.R) - Downloads respective databases from Enrichr for fGSEA analysis. Produces single gene sets database enrichr_database.tsv
-   [07_analyse_gsea.R](scripts/07_analyse_gsea.R) - Runs fGSEA analysis on all data. Produces single results file results_gsea.tsv
-   [08_plot_gsea_results.R](scripts/08_plot_gsea_results.R) - Plots results of the fGSEA analysis
